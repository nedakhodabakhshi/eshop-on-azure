
apiVersion: apps/v1
kind: Deployment
metadata:
  name: eshop-web
spec:
  replicas: 1
  selector:
    matchLabels:
      app: eshop-web
  template:
    metadata:
      labels:
        app: eshop-web
    spec:
      containers:
        - name: eshop-web
          image: eshopacr123.azurecr.io/eshop-web:latest
          imagePullPolicy: Always
          ports:
            - containerPort: 8080          # ✅ به 8080 تغییر کرد
          env:
            - name: ASPNETCORE_URLS        # ✅ روی 8080 گوش بده
              value: "http://0.0.0.0:8080"
            - name: ASPNETCORE_ENVIRONMENT
              value: "Development"

            # مقادیر دمی برای بالا آمدن بدون بک‌اندها
            - name: IdentityUrl
              value: "http://dummy-identity"
            - name: BasketUrl
              value: "http://dummy-basket"
            - name: CatalogUrl
              value: "http://dummy-catalog"
            - name: OrderingUrl
              value: "http://dummy-ordering"
            - name: MarketingUrl
              value: "http://dummy-marketing"
            - name: PaymentUrl
              value: "http://dummy-payment"
            - name: LocationsUrl
              value: "http://dummy-locations"
            - name: SignalrHubUrl
              value: "http://dummy-signalr"
            - name: UseCustomizationData
              value: "False"
